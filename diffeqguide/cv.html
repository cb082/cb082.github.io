<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Fourier Series Visualization Module</title>

  <!-- Load MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

  <!-- Load SageCell -->
  <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: auto;
      line-height: 1.6;
      padding: 20px;
      background-color: #f8f8f8;
    }
    h1, h2, h3 { color: #003366; }
    section {
      background: #ffffff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 25px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    textarea {
      width: 100%;
      height: 380px;
      font-family: monospace;
    }
    .note {
      background: #eef4ff;
      border-left: 4px solid #003366;
      padding: 10px 12px;
      margin: 12px 0 18px;
      border-radius: 6px;
    }
    /* Loading spinner styles */
    #loading-message {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1em;
      color: #003366;
      margin-bottom: 15px;
    }
    .spinner {
      border: 4px solid #e0e0e0;
      border-top: 4px solid #003366;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>

<h1>Interactive Fourier Series Visualization Module</h1>

<p class="note">
This page embeds <strong>SageMathCell</strong> to compute Fourier coefficients and plot partial sums.
When first loaded, Sage may take 5–10 seconds to initialize — please be patient.
Once ready, click the blue <em>“Run Fourier Visualization”</em> button in each section, 
then use the slider for \(N\) to see the Fourier approximation converge.
</p>

<div id="loading-message">
  <div class="spinner"></div>Loading SageMathCell — please wait…
</div>

<p>
We visualize Fourier series on \([-L, L]\) (default \(L=\pi\)):
\[
f(x) \sim \frac{a_0}{2} + \sum_{n=1}^{\infty}
\left( a_n \cos\!\left(\frac{n\pi x}{L}\right) + b_n \sin\!\left(\frac{n\pi x}{L}\right) \right),
\]
where
\[
a_n = \frac{1}{L}\!\int_{-L}^{L} f(x)\cos\!\left(\frac{n\pi x}{L}\right)\,dx,\quad
b_n = \frac{1}{L}\!\int_{-L}^{L} f(x)\sin\!\left(\frac{n\pi x}{L}\right)\,dx.
\]
</p>

<h2>1) Odd Function: \( f(x) = x \)</h2>
<section id="odd">
  <p>For this odd function, the Fourier series has only <em>sine</em> terms.</p>
  <div class="sagecell">
    <textarea data-language="sage">
var('x, n')
f(x) = x
L = pi

a0 = (1/L)*integral(f(x), (x, -L, L))
an(n) = (1/L)*integral(f(x)*cos(n*pi*x/L), (x, -L, L))
bn(n) = (1/L)*integral(f(x)*sin(n*pi*x/L), (x, -L, L))

def S_N(x, N):
    return a0/2 + sum(an(k)*cos(k*pi*x/L) + bn(k)*sin(k*pi*x/L) for k in range(1, N+1))

@interact
def _(N=(1, 30)):
    show(plot(f(x), (x, -L, L), color='black', thickness=3, legend_label='f(x)')
         + plot(S_N(x, N), (x, -L, L), color='red', legend_label=f'N={N}'),
         ymin=-4, ymax=4, figsize=5)
</textarea>
  </div>
</section>

<h2>2) Even Function: \( f(x) = |x| \)</h2>
<section id="even">
  <p>For this even function, the Fourier series has only <em>cosine</em> terms.</p>
  <div class="sagecell">
    <textarea data-language="sage">
var('x, n')
f(x) = abs(x)
L = pi

a0 = (1/L)*integral(f(x), (x, -L, L))
an(n) = (1/L)*integral(f(x)*cos(n*pi*x/L), (x, -L, L))
bn(n) = (1/L)*integral(f(x)*sin(n*pi*x/L), (x, -L, L))

def S_N(x, N):
    return a0/2 + sum(an(k)*cos(k*pi*x/L) + bn(k)*sin(k*pi*x/L) for k in range(1, N+1))

@interact
def _(N=(1, 30)):
    show(plot(f(x), (x, -L, L), color='black', thickness=3, legend_label='f(x)')
         + plot(S_N(x, N), (x, -L, L), color='blue', legend_label=f'N={N}'),
         ymin=-1, ymax=4, figsize=5)
</textarea>
  </div>
</section>

<h2>3) Custom Function</h2>
<section id="custom">
  <p>Enter any function of <code>x</code> (e.g., <code>sin(x)</code>, <code>x^2</code>, <code>abs(x)</code>, or a <code>piecewise</code> definition).</p>
  <div class="sagecell">
    <textarea data-language="sage">
var('x, n')
# Enter your function below:
f(x) = x^2   # Change this line to define your own function
L = pi

a0 = (1/L)*integral(f(x), (x, -L, L))
an(n) = (1/L)*integral(f(x)*cos(n*pi*x/L), (x, -L, L))
bn(n) = (1/L)*integral(f(x)*sin(n*pi*x/L), (x, -L, L))

def S_N(x, N):
    return a0/2 + sum(an(k)*cos(k*pi*x/L) + bn(k)*sin(k*pi*x/L) for k in range(1, N+1))

@interact
def _(N=(1, 30)):
    show(plot(f(x), (x, -L, L), color='black', thickness=3, legend_label='f(x)')
         + plot(S_N(x, N), (x, -L, L), color='green', legend_label=f'N={N}'),
         ymin=-4, ymax=4, figsize=5)
</textarea>
  </div>
</section>

<script>
  // Initialize SageCells only after DOM has loaded
  window.onload = function() {
    const loading = document.getElementById("loading-message");
    sagecell.makeSagecell({
      inputLocation: '.sagecell',
      evalButtonText: 'Run Fourier Visualization',
      linked: false,
      callback: function() {
        // Hide the loading spinner when SageCell finishes initializing
        loading.style.display = 'none';
      }
    });
  };
</script>

</body>
</html>