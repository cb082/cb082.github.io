<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Spring–Mass Oscillator Explorer</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
  <style>

<iframe src="https://sagecell.sagemath.org/?code=@interact%0Adef%20spring_mass_system(m%3Dsl...)" 
        width="100%" height="600" style="border:none;">
</iframe>

    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: auto;
      line-height: 1.6;
      padding: 20px;
      background-color: #f8f8f8;
    }
    h1, h2, h3 {
      color: #003366;
    }
    section {
      background: #ffffff;
      border-radius: 8px;
      padding: 18px;
      margin: 20px 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }
    .note {
      background: #eef4ff;
      border-left: 4px solid #003366;
      padding: 12px;
      border-radius: 6px;
    }
    textarea {
      width: 100%;
      height: 450px;
      font-family: monospace;
    }
    .spinner {
      border: 4px solid #e0e0e0;
      border-top: 4px solid #003366;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    #loading {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1em;
      color: #003366;
      margin: 20px 0;
    }
  </style>
</head>
<body>

<h1>Interactive Spring–Mass Oscillator Explorer</h1>

<div class="note">
  This interactive tool lets you explore how a spring–mass system responds to damping and external forcing.
  You can adjust parameters and visualize \(x(t)\) and the driving force \(F_0\cos(\omega t)\).
</div>

<section>
  <h2>Mathematical Model</h2>
  <p>
    The governing equation is:
    \[
    m\frac{d^2x}{dt^2} + c\frac{dx}{dt} + kx = F_0\cos(\omega t).
    \]
    The total solution is:
    \[
    x(t) = x_h(t) + x_p(t),
    \]
    where \(x_h\) is the transient (homogeneous) part, and \(x_p\) is the steady-state response.
  </p>
</section>

<section>
  <h2>Try It Yourself!</h2>
  <div id="loading"><div class="spinner"></div>Loading SageMathCell...</div>

  <div class="sagecell">
    <textarea data-language="sage">
# Interactive Spring–Mass System Simulation
# Explore the effect of mass m, damping c, stiffness k, and driving frequency omega.

@interact
def spring_mass_system(m=slider(0.1,10,0.1,1,label='Mass m'),
                       c=slider(0,5,0.1,0.5,label='Damping c'),
                       k=slider(0.1,20,0.1,9,label='Spring constant k'),
                       F0=slider(0,10,0.1,2,label='Driving amplitude F0'),
                       omega=slider(0,10,0.1,3,label='Driving frequency ω'),
                       tmax=slider(5,50,1,20,label='Time window')):
    
    var('t')
    omega0 = sqrt(k/m)
    gamma = c/(2*m)
    
    # Particular (steady-state) amplitude
    A = (F0/m) / sqrt((omega0^2 - omega^2)^2 + (2*gamma*omega)^2)
    phi = atan2(2*gamma*omega, omega0^2 - omega^2)
    
    # Homogeneous (transient) solution (underdamped assumption)
    omega1 = sqrt(max(omega0^2 - gamma^2, 0))
    x_h = exp(-gamma*t)*(cos(omega1*t) + sin(omega1*t))
    
    # Steady-state solution
    x_p = A*cos(omega*t - phi)
    
    # Total response (scaled transient)
    x_total = x_h + x_p
    
    p1 = plot(x_total, (t,0,tmax), color='red', thickness=2, legend_label='x(t): total response')
    p2 = plot(x_p, (t,0,tmax), color='blue', linestyle='--', legend_label='Steady-state')
    p3 = plot(F0*cos(omega*t)/max(k,1e-6), (t,0,tmax), color='green', linestyle=':', legend_label='Driving force (scaled)')
    
    show(p1 + p2 + p3, figsize=6, ymin=-5, ymax=5)
    
    pretty_print(html(f"""
    <b>Natural frequency:</b> ω₀ = {omega0.n(digits=3)}<br>
    <b>Damping ratio:</b> γ = {gamma.n(digits=3)}<br>
    <b>Amplitude of steady-state:</b> A = {A.n(digits=3)}<br>
    <b>Phase lag:</b> φ = {phi.n(digits=3)} rad
    """))
    </textarea>
  </div>
</section>

<section>
  <h2>Explore Physically</h2>
  <ul>
    <li>Increase \(c\) to see the transient die faster.</li>
    <li>Adjust \(\omega\) close to the natural frequency \(\omega_0 = \sqrt{k/m}\) to observe <strong>resonance</strong>.</li>
    <li>Compare the red curve (total response) and blue curve (steady-state).</li>
    <li>Notice how the steady-state amplitude \(A\) varies with \(\omega\).</li>
  </ul>
</section>

<section>
  <h2>Further Study</h2>
  <p>Pair this with the module on <em>Damped and Driven Oscillations</em> to analyze the resonance curve and the Laplace transform solutions for similar systems.</p>
  <p>For more visualizations, check out:</p>
  <ul>
    <li><a href="https://www.youtube.com/watch?v=_eyF-F7Pl8c" target="_blank">Driven and Resonant Oscillations</a></li>
    <li><a href="https://www.youtube.com/watch?v=pCkJtM0Bv0g" target="_blank">Mechanical Resonance and Phase Lag</a></li>
  </ul>
</section>

<script>
  window.addEventListener('load', function() {
    const loader = document.getElementById('loading');
    sagecell.makeSagecell({
      inputLocation: '.sagecell',
      evalButtonText: 'Run Interactive Simulation',
      linked: false,
      callback: function() {
        loader.style.display = 'none';
      }
    });
  });
</script>

</body>
</html>